<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYC Validation Hub - Swift AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Inter:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles/new-style.css">
    <style>
        :root {
            --kyc-bg: #f8f9fa;
            --kyc-card: #fff;
            --kyc-text: #212529;
            --kyc-border: #e9ecef;
            --monitor-bg: #020617;
        }

        body.dark-mode {
            --kyc-bg: #0f172a;
            --kyc-card: #1e293b;
            --kyc-text: #f8f9fa;
            --kyc-border: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: var(--kyc-bg);
            color: var(--kyc-text);
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }

        .kyc-hub {
            background: var(--kyc-card);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--kyc-border);
        }

        .kyc-monitor {
            background: var(--monitor-bg);
            font-family: 'IBM Plex Mono', monospace;
            padding: 1.5rem;
            color: #38bdf8;
            font-size: 0.85rem;
            height: 400px;
            overflow-y: auto;
            border-top: 4px solid #38bdf8;
        }

        .verification-card {
            background: var(--kyc-card);
            border: 1px solid var(--kyc-border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .verification-card.verifying {
            border-left: 4px solid #38bdf8;
            background: rgba(56, 189, 248, 0.05);
        }

        .verification-card.success {
            border-left: 4px solid #10b981;
        }

        .verification-card.failed {
            border-left: 4px solid #f43f5e;
        }

        .scan-line {
            height: 2px;
            background: #38bdf8;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            box-shadow: 0 0 10px #38bdf8;
            animation: scan 2s linear infinite;
            display: none;
        }

        @keyframes scan {
            0% {
                top: 0;
            }

            100% {
                top: 100%;
            }
        }

        .id-preview {
            position: relative;
            width: 100px;
            height: 140px;
            background: #0f172a;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container-fluid px-4">
            <a class="navbar-brand d-flex align-items-center" href="dashboard.html">
                <i class="fas fa-fingerprint text-info fs-3 me-2"></i>
                <span class="fw-bold fs-4">Swift AI | <span class="text-info small fw-normal">KYC
                        Validator</span></span>
            </a>
            <div class="ms-auto d-flex align-items-center gap-3">
                <button class="btn btn-outline-secondary btn-sm rounded-circle" id="themeToggle" onclick="toggleTheme()"
                    style="width: 38px; height: 38px;">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                <span class="badge bg-info text-dark d-none d-md-inline-block"><i class="fas fa-database me-1"></i>
                    Global Reach: 180+ Countries</span>
                <a href="bank-portal.html" class="btn btn-outline-info btn-sm">Back to Bank</a>
            </div>
        </div>
    </nav>

    <div class="container py-4">
        <div class="row g-4">
            <!-- Search & Filter -->
            <div class="col-lg-12">
                <div class="card border-0 shadow-sm bg-dark p-3">
                    <div class="row align-items-center">
                        <div class="col-md-4">
                            <h5 class="mb-0 fw-bold"><i class="fas fa-search-plus me-2 text-info"></i>Pending
                                Verifications</h5>
                        </div>
                        <div class="col-md-8">
                            <div class="input-group">
                                <span class="input-group-text bg-dark border-secondary text-info"><i
                                        class="fas fa-filter"></i></span>
                                <input type="text" class="form-control bg-dark text-white border-secondary"
                                    placeholder="Search by Name, Document ID, or Country...">
                                <button class="btn btn-info px-4" onclick="simulateNewKYC()">Process New Batch</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- KYC Queue -->
            <div class="col-lg-8">
                <div id="kycQueue">
                    <!-- Sample Item -->
                    <div class="verification-card success">
                        <div class="d-flex align-items-start gap-3">
                            <div class="id-preview">
                                <i class="fas fa-user-check text-success fs-1"></i>
                            </div>
                            <div class="flex-grow-1">
                                <div class="d-flex justify-content-between">
                                    <h6 class="fw-bold mb-1">John Doe</h6>
                                    <span class="badge bg-success">VERIFIED</span>
                                </div>
                                <div class="row g-2 mt-2">
                                    <div class="col-6">
                                        <small class="text-muted d-block">DOC TYPE</small>
                                        <small>Passport (USA)</small>
                                    </div>
                                    <div class="col-6">
                                        <small class="text-muted d-block">DOC NUMBER</small>
                                        <small>A8842-991</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Logs -->
            <div class="col-lg-4">
                <div class="kyc-hub">
                    <div class="p-3 border-bottom border-secondary">
                        <h6 class="mb-0 fw-bold text-info"><i class="fas fa-terminal me-2"></i>Global Validator Log</h6>
                    </div>
                    <div class="kyc-monitor" id="kycLogs">
                        <div>[SYSTEM] Validator Hub Initialized...</div>
                        <div>[SYSTEM] Connection to Interpol DB: OK</div>
                        <div>[SYSTEM] Neural OCR Engine: READY</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/app-seamless.js"></script>
    <script>
        function log(msg, type = '') {
            const logs = document.getElementById('kycLogs');
            const entry = document.createElement('div');
            entry.className = type ? `text-${type}` : '';
            entry.innerText = `[${new Date().toLocaleTimeString()}] ${msg}`;
            logs.appendChild(entry);
            logs.scrollTop = logs.scrollHeight;
        }

        async function simulateNewKYC() {
            const names = ['Sarah Jenkins', 'M. Khan', 'Elena Rossi', 'Unknown Entity', 'James Wilson'];
            const countries = ['UK', 'PK', 'IT', 'Hidden Proxy', 'Canada'];
            const idx = Math.floor(Math.random() * names.length);

            const name = names[idx];
            const country = countries[idx];

            const card = document.createElement('div');
            card.className = 'verification-card verifying';
            card.innerHTML = `
                <div class="d-flex align-items-start gap-3">
                    <div class="id-preview">
                        <div class="scan-line" style="display:block"></div>
                        <i class="fas fa-id-card-alt text-info fs-1"></i>
                    </div>
                    <div class="flex-grow-1">
                        <div class="d-flex justify-content-between align-items-center">
                            <h6 class="fw-bold mb-1">${name}</h6>
                            <span class="badge bg-info"><i class="fas fa-spinner fa-spin me-1"></i>ANALYZING</span>
                        </div>
                        <div class="row g-2 mt-2">
                            <div class="col-6">
                                <small class="text-muted d-block">COUNTRY</small>
                                <small class="fw-bold">${country}</small>
                            </div>
                            <div class="col-6">
                                <small class="text-muted d-block">PROCESS ID</small>
                                <small class="fw-bold">KYC-${Math.floor(Math.random() * 9000 + 1000)}</small>
                            </div>
                        </div>
                        <div class="mt-2" id="checks-${name.replace(/\s/g, '')}">
                            <div class="progress" style="height: 4px;">
                                <div class="progress-bar progress-bar-striped progress-bar-animated bg-info" style="width: 10%"></div>
                            </div>
                            <small class="text-muted extra-small" style="font-size: 0.7rem">System Check: Initializing...</small>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('kycQueue').prepend(card);

            log(`Contacting Global KYC Backend for ${name}...`);

            try {
                // Call real backend
                const response = await fetch('/api/kyc/verify', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, country })
                });
                const result = await response.json();

                // Update UI based on backend result
                setTimeout(() => {
                    const badge = card.querySelector('.badge');
                    const scan = card.querySelector('.scan-line');
                    const icon = card.querySelector('.id-preview i');
                    const statusText = card.querySelector('.extra-small');
                    const bar = card.querySelector('.progress-bar');

                    scan.style.display = 'none';
                    bar.parentElement.style.display = 'none';

                    if (result.status === 'Failed') {
                        card.className = 'verification-card failed';
                        badge.className = 'badge bg-danger';
                        badge.innerText = 'FORGERY DETECTED';
                        icon.className = 'fas fa-user-times text-danger fs-1';
                        statusText.className = 'text-danger fw-bold';
                        statusText.innerText = `ALERT: ${result.details.document_check} document detected!`;
                        log(`CRITICAL: KYC Failed for ${name}!`, 'danger');
                    } else {
                        card.className = 'verification-card success';
                        badge.className = 'badge bg-success';
                        badge.innerText = 'VERIFIED';
                        icon.className = 'fas fa-user-check text-success fs-1';
                        statusText.className = 'text-success fw-bold';
                        statusText.innerText = 'Validation Complete: Trusted Identity';
                        log(`Success: ${name} verified by AI Backend.`, 'success');
                    }
                }, 3000);

            } catch (error) {
                console.error('KYC Backend Error:', error);
                log('System Error: KYC Service Unreachable', 'danger');
            }
        }
    </script>
</body>

</html>